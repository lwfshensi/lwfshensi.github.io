<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>sharding-jdbc极简使用 | 肆叔的酱油</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="如果不想引入大数据的技术栈，同时还想处理大数据量的问题，那么来考虑shareding-sphere吧。  官方提供了两种方式：sharding-jdbc和sharding-proxy。区别就是jdbc采用jar包的方式集成，proxy直接是独立的服务在数据库和应用层之间实现。  这里采用更轻量的方式实现。  核心概念如下：    分表：将数据按照特定的规则散落到不同的表中存储    分库：将数">
<meta property="og:type" content="article">
<meta property="og:title" content="sharding-jdbc极简使用">
<meta property="og:url" content="http://yoursite.com/2024/07/18/sharding-jdbc-beggin/index.html">
<meta property="og:site_name" content="肆叔的酱油">
<meta property="og:description" content="如果不想引入大数据的技术栈，同时还想处理大数据量的问题，那么来考虑shareding-sphere吧。  官方提供了两种方式：sharding-jdbc和sharding-proxy。区别就是jdbc采用jar包的方式集成，proxy直接是独立的服务在数据库和应用层之间实现。  这里采用更轻量的方式实现。  核心概念如下：    分表：将数据按照特定的规则散落到不同的表中存储    分库：将数">
<meta property="og:image" content="http://yoursite.com/2024/07/18/sharding-jdbc-beggin/sharding.png">
<meta property="og:updated_time" content="2024-07-18T09:41:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sharding-jdbc极简使用">
<meta name="twitter:description" content="如果不想引入大数据的技术栈，同时还想处理大数据量的问题，那么来考虑shareding-sphere吧。  官方提供了两种方式：sharding-jdbc和sharding-proxy。区别就是jdbc采用jar包的方式集成，proxy直接是独立的服务在数据库和应用层之间实现。  这里采用更轻量的方式实现。  核心概念如下：    分表：将数据按照特定的规则散落到不同的表中存储    分库：将数">
<meta name="twitter:image" content="http://yoursite.com/2024/07/18/sharding-jdbc-beggin/sharding.png">
  
    <link rel="alternate" href="/atom.xml" title="肆叔的酱油" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">肆叔的酱油</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-sharding-jdbc-beggin" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/07/18/sharding-jdbc-beggin/" class="article-date">
  <time datetime="2024-07-18T08:36:40.000Z" itemprop="datePublished">2024-07-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sharding-jdbc极简使用
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>  如果不想引入大数据的技术栈，同时还想处理大数据量的问题，那么来考虑shareding-sphere吧。<br>  官方提供了两种方式：sharding-jdbc和sharding-proxy。区别就是jdbc采用jar包的方式集成，proxy直接是独立的服务在数据库和应用层之间实现。<br>  这里采用更轻量的方式实现。<br>  核心概念如下：<br>    分表：将数据按照特定的规则散落到不同的表中存储<br>    分库：将数据按照特定的规则散落到不同的数据库中<br>    分库分表：将数据按照特定的规则散落到不同的数据库中不同的表中<br>    分片键：分表规则依赖的字段<br>    分片算法：分表规则<br>    读写分离：主库写从库读<br>    数据脱敏：数据库字段加密解密<br>    分布式ID：分库分表后涉及的业务ID采用分布式ID,目前提供两种（UUID 和 SnowFlake）<br>  集成方式：<br>  1、添加maven依赖，以当是的版本为例子 4.0.1：<br>  <figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">    &lt; dependency &gt;</div><div class="line">    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;sharding-jdbc-spring-boot-starter&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;$&#123;sharding-jdbc.version&#125;&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">  </div></pre></td></tr></table></figure><br>  2、分库分表配置<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">#ds0 的DataSource配置</div><div class="line">spring.shardingsphere.datasource.ds0.type=org.apache.commons.dbcp2.BasicDataSource</div><div class="line">spring.shardingsphere.datasource.ds0.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.ds0.url=jdbc:mysql://localhost:3306/ds0</div><div class="line">spring.shardingsphere.datasource.ds0.username=root</div><div class="line">spring.shardingsphere.datasource.ds0.password=</div><div class="line">#ds1 的DataSource配置</div><div class="line">spring.shardingsphere.datasource.ds1.type=org.apache.commons.dbcp2.BasicDataSource</div><div class="line">spring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.ds1.url=jdbc:mysql://localhost:3306/ds1</div><div class="line">spring.shardingsphere.datasource.ds1.username=root</div><div class="line">spring.shardingsphere.datasource.ds1.password=</div><div class="line">#分库策略</div><div class="line">spring.shardingsphere.sharding.default-database-strategy.inline.sharding-column=user_id</div><div class="line">spring.shardingsphere.sharding.default-database-strategy.inline.algorithm-expression=ds$-&gt;&#123;user_id % 2&#125;</div><div class="line">#分表策略</div><div class="line">spring.shardingsphere.sharding.tables.t_order.actual-data-nodes=ds$-&gt;&#123;0..1&#125;.t_order$-&gt;&#123;0..1&#125;</div><div class="line">spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.sharding-column=order_id</div><div class="line">spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.algorithm-expression=t_order$-&gt;&#123;order_id % 2&#125;</div><div class="line">#关联表分表策略</div><div class="line">spring.shardingsphere.sharding.tables.t_order_item.actual-data-nodes=ds$-&gt;&#123;0..1&#125;.t_order_item$-&gt;&#123;0..1&#125;</div><div class="line">spring.shardingsphere.sharding.tables.t_order_item.table-strategy.inline.sharding-column=order_id</div><div class="line">spring.shardingsphere.sharding.tables.t_order_item.table-strategy.inline.algorithm-expression=t_order_item$-&gt;&#123;order_id % 2&#125;</div></pre></td></tr></table></figure></p>
<p>  3、读写分离配置<br>  <figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">   spring.shardingsphere.datasource.names=master,slave0,slave1</div><div class="line">#master 的DataSource配置</div><div class="line">spring.shardingsphere.datasource.master.type=org.apache.commons.dbcp.BasicDataSource</div><div class="line">spring.shardingsphere.datasource.master.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.master.url=jdbc:mysql://localhost:3306/master</div><div class="line">spring.shardingsphere.datasource.master.username=root</div><div class="line">spring.shardingsphere.datasource.master.password=</div><div class="line">#slave0 的DataSource配置</div><div class="line">spring.shardingsphere.datasource.slave0.type=org.apache.commons.dbcp.BasicDataSource</div><div class="line">spring.shardingsphere.datasource.slave0.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.slave0.url=jdbc:mysql://localhost:3306/slave0</div><div class="line">spring.shardingsphere.datasource.slave0.username=root</div><div class="line">spring.shardingsphere.datasource.slave0.password=</div><div class="line">#slave1 的DataSource配置</div><div class="line">spring.shardingsphere.datasource.slave1.type=org.apache.commons.dbcp.BasicDataSource</div><div class="line">spring.shardingsphere.datasource.slave1.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.slave1.url=jdbc:mysql://localhost:3306/slave1</div><div class="line">spring.shardingsphere.datasource.slave1.username=root</div><div class="line">spring.shardingsphere.datasource.slave1.password=</div><div class="line">#主从配置</div><div class="line">spring.shardingsphere.masterslave.name=ms</div><div class="line">spring.shardingsphere.masterslave.master-data-source-name=master</div><div class="line">spring.shardingsphere.masterslave.slave-data-source-names=slave0,slave1</div><div class="line">  </div></pre></td></tr></table></figure></p>
<p>  4、数据脱敏<br>  <figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">spring.shardingsphere.datasource.name=ds</div><div class="line">#ds 的DataSource配置</div><div class="line">spring.shardingsphere.datasource.ds.type=org.apache.commons.dbcp2.BasicDataSource</div><div class="line">spring.shardingsphere.datasource.ds.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.ds.url=jdbc:mysql://127.0.0.1:3306/encrypt?serverTimezone=UTC&amp;useSSL=false</div><div class="line">spring.shardingsphere.datasource.ds.username=root</div><div class="line">spring.shardingsphere.datasource.ds.password=</div><div class="line">spring.shardingsphere.datasource.ds.max-total=100</div><div class="line">#数据脱敏规则配置</div><div class="line">spring.shardingsphere.encrypt.encryptors.encryptor_aes.type=aes</div><div class="line">spring.shardingsphere.encrypt.encryptors.encryptor_aes.props.aes.key.value=123456</div><div class="line">#  存储明文的字段</div><div class="line">spring.shardingsphere.encrypt.tables.t_order.columns.user_id.plainColumn=user_decrypt</div><div class="line">#  存储密文的字段</div><div class="line">spring.shardingsphere.encrypt.tables.t_order.columns.user_id.cipherColumn=user_encrypt</div><div class="line">#  加密器名字</div><div class="line">spring.shardingsphere.encrypt.tables.t_order.columns.user_id.encryptor=encryptor_aes</div><div class="line"></div><div class="line">spring.shardingsphere.props.sql.show=true</div></pre></td></tr></table></figure></p>
<p>  5、完整例子：<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#shareding配置相关</div><div class="line">spring.shardingsphere.datasource.names = wechatmaster,wechatslave</div><div class="line"># 主数据源</div><div class="line">spring.shardingsphere.datasource.wechatmaster.type = com.alibaba.druid.pool.DruidDataSource</div><div class="line">spring.shardingsphere.datasource.wechatmaster.driver-class-name = com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.wechatmaster.url = jdbc: mysql://localhost:3306/wechat?characterEncoding=utf-8</div><div class="line">spring.shardingsphere.datasource.wechatmaster.username = wechat_w</div><div class="line">spring.shardingsphere.datasource.wechatmaster.password =</div><div class="line">#从库数据源</div><div class="line">spring.shardingsphere.datasource.wechatslave.type = com.alibaba.druid.pool.DruidDataSource</div><div class="line">spring.shardingsphere.datasource.wechatslave.driver-class-name = com.mysql.jdbc.Driver</div><div class="line">spring.shardingsphere.datasource.wechatslave.url = jdbc: mysql://localhost:3306/wechat?characterEncoding=utf-8</div><div class="line">spring.shardingsphere.datasource.wechatslave.username = wechat_w</div><div class="line">spring.shardingsphere.datasource.wechatslave.password =</div><div class="line"># wechat_query_result_log 分表策略</div><div class="line">spring.shardingsphere.sharding.tables.wechat_query_result_log.actual-data-nodes = wecchatmaster.wechat_query_result_log$-&gt;&#123;0..1&#125;</div><div class="line">spring.shardingsphere.sharding.tables.wechat_query_result_log.table-strategy.inline.sharding-column = org_code</div><div class="line">spring.shardingsphere.sharding.tables.wechat_query_result_log.table-strategy.inline.algorithm-expression = wechat_result_log$-&gt;&#123; Long.parseLong(org_code.replaceAll(&apos;[a-z]&apos;,&apos;&apos;).replaceAll(&apos;[A-Z]&apos;,&apos;&apos;)) % 2&#125;</div><div class="line"># inout_record 分表策略</div><div class="line">spring.shardingsphere.sharding.tables.inout_record.actual-data-nodes = wechatmaster.inout_record$-&gt;&#123;0..1&#125;</div><div class="line">spring.shardingsphere.sharding.tables.inout_record.table-strategy.inline.sharding-column = org_code</div><div class="line">spring.shardingsphere.sharding.tables.inout_record.table-strategy.inline.algorithm-expression = inout_record$-&gt;&#123; Long.parseLong(org_code.replaceAll(&apos;[a-z]&apos;,&apos;&apos;).replaceAll(&apos;[A-Z]&apos;,&apos;&apos;)) % 2&#125;</div><div class="line">#绑定表</div><div class="line">spring.shardingsphere.sharding.binding-tables = wechat_result_log</div><div class="line">#读写分离</div><div class="line">spring.shardingsphere.sharding.master-slave-rules.wechatmaster.master-data-source-name = wechatmaster</div><div class="line">spring.shardingsphere.sharding.master-slave-rules.wechatmaster.slave-data-source-names = wechatslave</div><div class="line">#负载均衡</div><div class="line">spring.shardingsphere.masterslave.load-balance-algorithm-type = round_robin</div><div class="line"># 数据脱敏</div><div class="line">#check_log 表脱敏规则</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.encryptors.encryptor_aes.type = haes</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.encryptors.encryptor_aes.props.aes.key.value = $&#123;encrypt.public.key&#125;</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.check_log.columns.id_card.cipherColumn = id_card</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.check_log.columns.id_card.encryptor = encryptor_aes</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.check_log.columns.phone.cipherColumn = phone</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.check_log.columns.phone.encryptor = encryptor_aes</div><div class="line">#employee 表脱敏规则</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.employee.columns.id_card.cipherColumn = id_card</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.employee.columns.id_card.encryptor = encryptor_aes</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.employee.columns.mobile.cipherColumn = mobile</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.employee.columns.mobile.encryptor = encryptor_aes</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.employee.columns.passport.cipherColumn = passport</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.employee.columns.passport.encryptor = encryptor_aes</div><div class="line">#wechat_query_result_log 表脱敏规则</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.wechat_result_log.columns.id_card.cipherColumn = id_card</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.wechat_result_log.columns.id_card.encryptor = encryptor_aes</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.wechat_result_log.columns.mobile.cipherColumn = mobile</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.wechat_result_log.columns.mobile.encryptor = encryptor_aes</div><div class="line">#visitor 表脱敏规则</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.visitor.columns.id_card.cipherColumn = id_card</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.visitor.columns.id_card.encryptor = encryptor_aes</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.visitor.columns.mobile.cipherColumn = mobile</div><div class="line">spring.shardingsphere.sharding.encrypt-rule.tables.visitor.columns.mobile.encryptor = encryptor_aes</div><div class="line">#是否开启sql打印</div><div class="line">spring.shardingsphere.props.sql.show = false</div></pre></td></tr></table></figure></p>
<p> 代码配置：<br> <figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">@SpringBootApplication (exclude = &#123;DataSourceAutoConfiguration. class &#125;)</div><div class="line">public class SharedingApplication &#123;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        SpringApplication.run(SharedingApplication.class, args);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">import org.apache.shardingsphere.shardingjdbc.spring.boot.SpringBootConfiguration;</div><div class="line">@Configuration</div><div class="line">@MapperScan(basePackages = &quot;cn.wechat.mapper&quot;, sqlSessionTemplateRef = &quot;wechatSqlSessionTemplate&quot;)</div><div class="line">@AutoConfigureBefore(YmsConfig.class)</div><div class="line">@AutoConfigureAfter(SpringBootConfiguration.class)</div><div class="line">public class WechatConfig &#123;</div><div class="line"></div><div class="line">    @Bean(name = &quot;wechatDataSource&quot;)</div><div class="line">    @Primary</div><div class="line">  public DataSource wechatDataSource(@Qualifier(&quot;shardingDataSource&quot;) DataSource dataSource) &#123;</div><div class="line">        return dataSource;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean(name = &quot;wechatSqlSessionFactory&quot;)</div><div class="line">    @Primary</div><div class="line">  public SqlSessionFactory wechatSqlSessionFactory(@Qualifier(&quot;wechatDataSource&quot;) DataSource dataSource) throws Exception &#123;</div><div class="line">        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();</div><div class="line">        bean.setDataSource(dataSource);</div><div class="line">        // 分页插件</div><div class="line">  PageHelper pageHelper = new PageHelper();</div><div class="line">        Properties properties = new Properties();</div><div class="line">        properties.setProperty(&quot;reasonable&quot;, &quot;true&quot;);</div><div class="line">        properties.setProperty(&quot;supportMethodsArguments&quot;, &quot;true&quot;);</div><div class="line">        properties.setProperty(&quot;returnPageInfo&quot;, &quot;check&quot;);</div><div class="line">        properties.setProperty(&quot;params&quot;, &quot;count=countSql&quot;);</div><div class="line">        properties.setProperty(&quot;pageSizeZero&quot;, &quot;true&quot;);</div><div class="line">        /**</div><div class="line"> * 分页参数合理化</div><div class="line"> * 启用合理化时，如果pageNum&lt;1会查询第一页，如果pageNum&gt;pages会查询最后一页</div><div class="line"> * 禁用合理化时，如果pageNum&lt;1或pageNum&gt;pages会返回空数据</div><div class="line"> */</div><div class="line">  properties.setProperty(&quot;reasonable&quot;, &quot;false&quot;);</div><div class="line">        pageHelper.setProperties(properties);</div><div class="line"></div><div class="line">        // 添加插件</div><div class="line">  bean.setPlugins(new Interceptor[]&#123;pageHelper&#125;);</div><div class="line">        bean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(&quot;classpath:mybatis/mapper/wechat/*.xml&quot;));</div><div class="line">        return bean.getObject();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean(name = &quot;wechatTransactionManager&quot;)</div><div class="line">    @Primary</div><div class="line">  public DataSourceTransactionManager wechatTransactionManager(@Qualifier(&quot;wechatDataSource&quot;) DataSource dataSource) &#123;</div><div class="line">        return new DataSourceTransactionManager(dataSource);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean(name = &quot;wechatSqlSessionTemplate&quot;)</div><div class="line">    @Primary</div><div class="line">  public SqlSessionTemplate wechatSqlSessionTemplate(@Qualifier(&quot;wechatSqlSessionFactory&quot;) SqlSessionFactory sqlSessionFactory) throws Exception &#123;</div><div class="line">        return new SqlSessionTemplate(sqlSessionFactory);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后一些实现原理<br>SpringBootConfiguration：<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">@AutoConfigureBefore(&#123;DataSourceAutoConfiguration.class&#125;)</div><div class="line">public class SpringBootConfiguration implements EnvironmentAware &#123;</div><div class="line">    private final SpringBootShardingRuleConfigurationProperties shardingRule;</div><div class="line">    private final SpringBootMasterSlaveRuleConfigurationProperties masterSlaveRule;</div><div class="line">    private final SpringBootEncryptRuleConfigurationProperties encryptRule;</div><div class="line">    private final SpringBootPropertiesConfigurationProperties props;</div><div class="line">    private final Map&lt;String, DataSource&gt; dataSourceMap = new LinkedHashMap();</div><div class="line">    private final String jndiName = &quot;jndi-name&quot;;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    @Conditional(&#123;ShardingRuleCondition.class&#125;)</div><div class="line">    public DataSource shardingDataSource() throws SQLException &#123;</div><div class="line">        return ShardingDataSourceFactory.createDataSource(this.dataSourceMap, (new ShardingRuleConfigurationYamlSwapper()).swap(this.shardingRule), this.props.getProps());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    @Conditional(&#123;MasterSlaveRuleCondition.class&#125;)</div><div class="line">    public DataSource masterSlaveDataSource() throws SQLException &#123;</div><div class="line">        return MasterSlaveDataSourceFactory.createDataSource(this.dataSourceMap, (new MasterSlaveRuleConfigurationYamlSwapper()).swap(this.masterSlaveRule), this.props.getProps());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    @Conditional(&#123;EncryptRuleCondition.class&#125;)</div><div class="line">    public DataSource encryptDataSource() throws SQLException &#123;</div><div class="line">        return EncryptDataSourceFactory.createDataSource((DataSource)this.dataSourceMap.values().iterator().next(), (new EncryptRuleConfigurationYamlSwapper()).swap(this.encryptRule), this.props.getProps());</div><div class="line">    &#125;</div><div class="line"></div></pre></td></tr></table></figure></p>
<p>Datasource<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">//DataSource,重写getConnect()方法</div><div class="line">public class ShardingDataSource extends AbstractDataSourceAdapter &#123;</div><div class="line">    private final ShardingRuntimeContext runtimeContext;</div><div class="line"></div><div class="line">    public ShardingDataSource(Map&lt;String, DataSource&gt; dataSourceMap, ShardingRule shardingRule, Properties props) throws SQLException &#123;</div><div class="line">        super(dataSourceMap);</div><div class="line">        this.checkDataSourceType(dataSourceMap);</div><div class="line">        this.runtimeContext = new ShardingRuntimeContext(dataSourceMap, shardingRule, props, this.getDatabaseType());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void checkDataSourceType(Map&lt;String, DataSource&gt; dataSourceMap) &#123;</div><div class="line">        Iterator var2 = dataSourceMap.values().iterator();</div><div class="line"></div><div class="line">        while(var2.hasNext()) &#123;</div><div class="line">            DataSource each = (DataSource)var2.next();</div><div class="line">            Preconditions.checkArgument(!(each instanceof MasterSlaveDataSource), &quot;Initialized data sources can not be master-slave data sources.&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public final ShardingConnection getConnection() &#123;</div><div class="line">        return new ShardingConnection(this.getDataSourceMap(), this.runtimeContext, TransactionTypeHolder.get());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ShardingRuntimeContext getRuntimeContext() &#123;</div><div class="line">        return this.runtimeContext;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ShardingConnection<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">//DataSource,重写getConnect()方法</div><div class="line">public class ShardingDataSource extends AbstractDataSourceAdapter &#123;</div><div class="line">    private final ShardingRuntimeContext runtimeContext;</div><div class="line"></div><div class="line">    public ShardingDataSource(Map&lt;String, DataSource&gt; dataSourceMap, ShardingRule shardingRule, Properties props) throws SQLException &#123;</div><div class="line">        super(dataSourceMap);</div><div class="line">        this.checkDataSourceType(dataSourceMap);</div><div class="line">        this.runtimeContext = new ShardingRuntimeContext(dataSourceMap, shardingRule, props, this.getDatabaseType());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void checkDataSourceType(Map&lt;String, DataSource&gt; dataSourceMap) &#123;</div><div class="line">        Iterator var2 = dataSourceMap.values().iterator();</div><div class="line"></div><div class="line">        while(var2.hasNext()) &#123;</div><div class="line">            DataSource each = (DataSource)var2.next();</div><div class="line">            Preconditions.checkArgument(!(each instanceof MasterSlaveDataSource), &quot;Initialized data sources can not be master-slave data sources.&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public final ShardingConnection getConnection() &#123;</div><div class="line">        return new ShardingConnection(this.getDataSourceMap(), this.runtimeContext, TransactionTypeHolder.get());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ShardingRuntimeContext getRuntimeContext() &#123;</div><div class="line">        return this.runtimeContext;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">ShardingConnection</div><div class="line"># ShardingConnection 实现</div><div class="line">public final class ShardingConnection extends AbstractConnectionAdapter &#123;</div><div class="line">    </div><div class="line">    private final Map&lt;String, DataSource&gt; dataSourceMap;</div><div class="line">    </div><div class="line">    private final ShardingRuntimeContext runtimeContext;</div><div class="line">    </div><div class="line">    private final TransactionType transactionType;</div><div class="line">    </div><div class="line">    private final ShardingTransactionManager shardingTransactionManager;</div><div class="line">    </div><div class="line">    public ShardingConnection(final Map&lt;String, DataSource&gt; dataSourceMap, final ShardingRuntimeContext runtimeContext, final TransactionType transactionType) &#123;</div><div class="line">        this.dataSourceMap = dataSourceMap;</div><div class="line">        this.runtimeContext = runtimeContext;</div><div class="line">        this.transactionType = transactionType;</div><div class="line">        shardingTransactionManager = runtimeContext.getShardingTransactionManagerEngine().getTransactionManager(transactionType);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    @Override</div><div class="line"> public PreparedStatement prepareStatement(final String sql) throws SQLException &#123;</div><div class="line">        return new ShardingPreparedStatement(this, sql);</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">ShardingPreparedStatement  executeQuery</div><div class="line">@Override</div><div class="line">public ResultSet executeQuery() throws SQLException &#123;</div><div class="line">    ResultSet result;</div><div class="line">    try &#123;</div><div class="line">        clearPrevious();</div><div class="line">        shard();</div><div class="line">        initPreparedStatementExecutor();</div><div class="line">        MergeEngine mergeEngine = MergeEngineFactory.newInstance(connection.getRuntimeContext().getDatabaseType(), </div><div class="line">                connection.getRuntimeContext().getRule(), sqlRouteResult, connection.getRuntimeContext().getMetaData().getRelationMetas(), preparedStatementExecutor.executeQuery());</div><div class="line">        result = getResultSet(mergeEngine);</div><div class="line">    &#125; finally &#123;</div><div class="line">        clearBatch();</div><div class="line">    &#125;</div><div class="line">    currentResultSet = result;</div><div class="line">    return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>BaseShardingEngine<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#BaseShardingEngine</div><div class="line">public SQLRouteResult shard(final String sql, final List&lt;Object&gt; parameters) &#123;</div><div class="line">    List&lt;Object&gt; clonedParameters = cloneParameters(parameters);</div><div class="line">    SQLRouteResult result = executeRoute(sql, clonedParameters);</div><div class="line">    result.getRouteUnits().addAll(HintManager.isDatabaseShardingOnly() ? convert(sql, clonedParameters, result) : rewriteAndConvert(sql, clonedParameters, result));</div><div class="line">    boolean showSQL = shardingProperties.getValue(ShardingPropertiesConstant.SQL_SHOW);</div><div class="line">    if (showSQL) &#123;</div><div class="line">        boolean showSimple = shardingProperties.getValue(ShardingPropertiesConstant.SQL_SIMPLE);</div><div class="line">        SQLLogger.logSQL(sql, showSimple, result.getSqlStatementContext(), result.getRouteUnits());</div><div class="line">    &#125;</div><div class="line">    return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>常见问题：<br>a、DataSource注入问题 : shareding-jdbc自定义了SpringBootConfiguration来注入DataSource,项目中可以排除springboot的DataSourceAutoConfiguration<br>b、使用DataSource : 可以直接使用 @Autowired DataSource datasource<br>c、自定义数据脱敏：注册脱敏器调用链 ShardingKeyGeneratorServiceLoader-&gt;NewInstanceServiceLoader→registe<br><figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#org.apache.shardingsphere.spi.keygen.ShardingKeyGenerator</div><div class="line">public static &lt; T &gt; void register( final Class&lt; T &gt; service) &#123;</div><div class="line">    for (T each : ServiceLoader.load(service)) &#123;</div><div class="line">        registerServiceClass(service, each);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ServiceLoader 是加载 META-INF/services/对应类名的文件，由此可以自定义脱敏器并重写文件<br><img src="/2024/07/18/sharding-jdbc-beggin/sharding.png" alt="code" title="code"></p>
<figure class="highlight plain"><figcaption><span>shell config</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">#自定义脱敏器</div><div class="line">@Getter</div><div class="line">@Setter</div><div class="line">@Slf4j</div><div class="line">public class HAESShardingEncryptor implements ShardingEncryptor &#123;</div><div class="line"></div><div class="line">    private static final String AES_KEY = &quot;aes.key.value&quot;;</div><div class="line"></div><div class="line">    private Properties properties = new Properties();</div><div class="line"></div><div class="line">    @Override</div><div class="line"> public String getType() &#123;</div><div class="line">        return &quot;HAES&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private final String AES = &quot;AES&quot;;</div><div class="line"></div><div class="line">    @Override</div><div class="line"> public void init() &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line"> @SneakyThrows</div><div class="line"> public String encrypt(final Object plaintext) &#123;</div><div class="line">        if (plaintext == null || &quot;null&quot;.equals(plaintext)) &#123;</div><div class="line">            return null;</div><div class="line">        &#125;</div><div class="line">        byte[] result = getCipher(Cipher.ENCRYPT_MODE).doFinal(StringUtils.getBytesUtf8(String.valueOf(plaintext)));</div><div class="line">        return new String(Hex.encodeHex(result, false));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line"> @SneakyThrows</div><div class="line"> public Object decrypt(final String ciphertext) &#123;</div><div class="line">        if (null == ciphertext) &#123;</div><div class="line">            return null;</div><div class="line">        &#125;</div><div class="line">        try &#123;</div><div class="line">            byte[] result = getCipher(Cipher.DECRYPT_MODE).doFinal(Hex.decodeHex(ciphertext.toCharArray()));</div><div class="line">            return new String(result, StandardCharsets.UTF_8);</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            log.error(&quot;解密异常 Given final block not properly padded. Such issues can arise if a bad key is used during decryption.&quot;, e);</div><div class="line">        &#125;</div><div class="line">        return null;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private Cipher getCipher(final int decryptMode) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException &#123;</div><div class="line">        Preconditions.checkArgument(properties.containsKey(AES_KEY), &quot;No available secret key for `%s`.&quot;, org.apache.shardingsphere.core.strategy.encrypt.impl.AESShardingEncryptor.class.getName());</div><div class="line">        Cipher result = Cipher.getInstance(AES);</div><div class="line">        result.init(decryptMode, new SecretKeySpec(createSecretKey(), AES));</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private byte[] createSecretKey() &#123;</div><div class="line">        Preconditions.checkArgument(null != properties.get(AES_KEY), String.format(&quot;%s can not be null.&quot;, AES_KEY));</div><div class="line"> try &#123;</div><div class="line">            final byte[] finalKey = new byte[16];</div><div class="line">            int i = 0;</div><div class="line">            for (byte b : properties.get(AES_KEY).toString().getBytes(Charsets.UTF_8.name())) &#123;</div><div class="line">                finalKey[i++ % 16] ^= b;</div><div class="line">            &#125;</div><div class="line">            return new SecretKeySpec(finalKey, AES).getEncoded();</div><div class="line">        &#125; catch (UnsupportedEncodingException e) &#123;</div><div class="line">            throw new RuntimeException(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>d、自带的分布式ID生成不会返回：自定义ID生成，动态赋值<br>e、字段映射：数据库实体中date 类型的不能映射成为LocalDate和LocalDateTime类型<br>f、表中避免使用 source作为字段，如果需要使用必须<code>source</code><br>g、支持分页、去重、排序、分组、聚合、关联查询（不支持跨库关联）；不支持CASE WHEN、HAVING、UNION (ALL)，有限支持子查询<br>f</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2024/07/18/sharding-jdbc-beggin/" data-id="clyy5k6fd0010yv79v68aio9e" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sharding-jdbc/">sharding-jdbc</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/07/21/how-to-install-k8s-with-rke/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          用RKE安装k8s
        
      </div>
    </a>
  
  
    <a href="/2024/07/18/influxdb-opt/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">influxdb优化</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/bigdata/">bigdata</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/influx-proxy/">influx-proxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s-rancher/">k8s rancher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openstack-neutron/">openstack neutron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sharding-jdbc/">sharding-jdbc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark-classload-ClassNotFound/">spark classload ClassNotFound</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-eureka/">spring eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tensroflow/">tensroflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zipkin-skywalking-cat/">zipkin skywalking cat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/阿里云-sgoop-presto/">阿里云 sgoop presto</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/bigdata/" style="font-size: 10px;">bigdata</a> <a href="/tags/flume/" style="font-size: 10px;">flume</a> <a href="/tags/influx-proxy/" style="font-size: 10px;">influx-proxy</a> <a href="/tags/k8s/" style="font-size: 10px;">k8s</a> <a href="/tags/k8s-rancher/" style="font-size: 10px;">k8s rancher</a> <a href="/tags/openstack-neutron/" style="font-size: 10px;">openstack neutron</a> <a href="/tags/sharding-jdbc/" style="font-size: 10px;">sharding-jdbc</a> <a href="/tags/spark-classload-ClassNotFound/" style="font-size: 10px;">spark classload ClassNotFound</a> <a href="/tags/spring/" style="font-size: 20px;">spring</a> <a href="/tags/spring-eureka/" style="font-size: 10px;">spring eureka</a> <a href="/tags/tensroflow/" style="font-size: 10px;">tensroflow</a> <a href="/tags/ubuntu/" style="font-size: 20px;">ubuntu</a> <a href="/tags/zipkin-skywalking-cat/" style="font-size: 10px;">zipkin skywalking cat</a> <a href="/tags/阿里云-sgoop-presto/" style="font-size: 10px;">阿里云 sgoop presto</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/07/23/hello-world/">如何搭建新版本hexo</a>
          </li>
        
          <li>
            <a href="/2024/07/23/ubuntu20-install-docker/">ubuntu20安装docker</a>
          </li>
        
          <li>
            <a href="/2024/07/22/unbuntu20-with-vbox7/">virtualbox7安装ubuntu20</a>
          </li>
        
          <li>
            <a href="/2024/07/21/how-to-install-k8s-with-rke/">用RKE安装k8s</a>
          </li>
        
          <li>
            <a href="/2024/07/18/sharding-jdbc-beggin/">sharding-jdbc极简使用</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 wfliu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>